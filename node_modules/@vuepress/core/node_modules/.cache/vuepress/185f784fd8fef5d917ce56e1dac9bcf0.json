{"remainingRequest":"D:\\xingkong\\lzx-vuepress\\node_modules\\babel-loader\\lib\\index.js??ref--3-1!D:\\xingkong\\lzx-vuepress\\node_modules\\@vuepress\\core\\lib\\client\\root-mixins\\updateMeta.js","dependencies":[{"path":"D:\\xingkong\\lzx-vuepress\\node_modules\\@vuepress\\core\\lib\\client\\root-mixins\\updateMeta.js","mtime":1692850741516},{"path":"D:\\xingkong\\lzx-vuepress\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1692850749134},{"path":"D:\\xingkong\\lzx-vuepress\\node_modules\\babel-loader\\lib\\index.js","mtime":1692850747279}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICJEOlxceGluZ2tvbmdcXGx6eC12dWVwcmVzc1xcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWVcXGhlbHBlcnNcXGVzbVxcdG9Db25zdW1hYmxlQXJyYXkuanMiOwppbXBvcnQgX3NsaWNlZFRvQXJyYXkgZnJvbSAiRDpcXHhpbmdrb25nXFxsengtdnVlcHJlc3NcXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lXFxoZWxwZXJzXFxlc21cXHNsaWNlZFRvQXJyYXkuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmtleXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5qc29uLnN0cmluZ2lmeS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmpvaW4uanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5jb25jYXQuanMiOwppbXBvcnQgdW5pb25CeSBmcm9tICdsb2Rhc2gvdW5pb25CeSc7CmV4cG9ydCBkZWZhdWx0IHsKICAvLyBjcmVhdGVkIHdpbGwgYmUgY2FsbGVkIG9uIGJvdGggY2xpZW50IGFuZCBzc3IKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgdGhpcy5zaXRlTWV0YSA9IHRoaXMuJHNpdGUuaGVhZFRhZ3MuZmlsdGVyKGZ1bmN0aW9uIChfcmVmKSB7CiAgICAgIHZhciBfcmVmMiA9IF9zbGljZWRUb0FycmF5KF9yZWYsIDEpLAogICAgICAgICAgaGVhZGVyVHlwZSA9IF9yZWYyWzBdOwoKICAgICAgcmV0dXJuIGhlYWRlclR5cGUgPT09ICdtZXRhJzsKICAgIH0pLm1hcChmdW5jdGlvbiAoX3JlZjMpIHsKICAgICAgdmFyIF9yZWY0ID0gX3NsaWNlZFRvQXJyYXkoX3JlZjMsIDIpLAogICAgICAgICAgXyA9IF9yZWY0WzBdLAogICAgICAgICAgaGVhZGVyVmFsdWUgPSBfcmVmNFsxXTsKCiAgICAgIHJldHVybiBoZWFkZXJWYWx1ZTsKICAgIH0pOwoKICAgIGlmICh0aGlzLiRzc3JDb250ZXh0KSB7CiAgICAgIHZhciBtZXJnZWRNZXRhSXRlbXMgPSB0aGlzLmdldE1lcmdlZE1ldGFUYWdzKCk7CiAgICAgIHRoaXMuJHNzckNvbnRleHQudGl0bGUgPSB0aGlzLiR0aXRsZTsKICAgICAgdGhpcy4kc3NyQ29udGV4dC5sYW5nID0gdGhpcy4kbGFuZzsKICAgICAgdGhpcy4kc3NyQ29udGV4dC5wYWdlTWV0YSA9IHJlbmRlclBhZ2VNZXRhKG1lcmdlZE1ldGFJdGVtcyk7CiAgICAgIHRoaXMuJHNzckNvbnRleHQuY2Fub25pY2FsTGluayA9IHJlbmRlckNhbm9uaWNhbExpbmsodGhpcy4kY2Fub25pY2FsVXJsKTsKICAgIH0KICB9LAogIC8vIE90aGVyIGxpZmUgY3ljbGVzIHdpbGwgb25seSBiZSBjYWxsZWQgYXQgY2xpZW50CiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIC8vIGluaXQgY3VycmVudE1ldGFUYWdzIGZyb20gRE9NCiAgICB0aGlzLmN1cnJlbnRNZXRhVGFncyA9IF90b0NvbnN1bWFibGVBcnJheShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdtZXRhJykpOyAvLyB1cGRhdGUgdGl0bGUgLyBtZXRhIHRhZ3MKCiAgICB0aGlzLnVwZGF0ZU1ldGEoKTsKICAgIHRoaXMudXBkYXRlQ2Fub25pY2FsTGluaygpOwogIH0sCiAgbWV0aG9kczogewogICAgdXBkYXRlTWV0YTogZnVuY3Rpb24gdXBkYXRlTWV0YSgpIHsKICAgICAgZG9jdW1lbnQudGl0bGUgPSB0aGlzLiR0aXRsZTsKICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmxhbmcgPSB0aGlzLiRsYW5nOwogICAgICB2YXIgbmV3TWV0YVRhZ3MgPSB0aGlzLmdldE1lcmdlZE1ldGFUYWdzKCk7CiAgICAgIHRoaXMuY3VycmVudE1ldGFUYWdzID0gdXBkYXRlTWV0YVRhZ3MobmV3TWV0YVRhZ3MsIHRoaXMuY3VycmVudE1ldGFUYWdzKTsKICAgIH0sCiAgICBnZXRNZXJnZWRNZXRhVGFnczogZnVuY3Rpb24gZ2V0TWVyZ2VkTWV0YVRhZ3MoKSB7CiAgICAgIHZhciBwYWdlTWV0YSA9IHRoaXMuJHBhZ2UuZnJvbnRtYXR0ZXIubWV0YSB8fCBbXTsgLy8gcGFnZU1ldGFUYWdzIGhhdmUgaGlnaGVyIHByaW9yaXR5IHRoYW4gc2l0ZU1ldGFUYWdzCiAgICAgIC8vIGRlc2NyaXB0aW9uIG5lZWRzIHNwZWNpYWwgYXR0ZW50aW9uIGFzIGl0IGhhcyB0b28gbWFueSBlbnRyaWVzCgogICAgICByZXR1cm4gdW5pb25CeShbewogICAgICAgIG5hbWU6ICdkZXNjcmlwdGlvbicsCiAgICAgICAgY29udGVudDogdGhpcy4kZGVzY3JpcHRpb24KICAgICAgfV0sIHBhZ2VNZXRhLCB0aGlzLnNpdGVNZXRhLCBtZXRhSWRlbnRpZmllcik7CiAgICB9LAogICAgdXBkYXRlQ2Fub25pY2FsTGluazogZnVuY3Rpb24gdXBkYXRlQ2Fub25pY2FsTGluaygpIHsKICAgICAgcmVtb3ZlQ2Fub25pY2FsTGluaygpOwoKICAgICAgaWYgKCF0aGlzLiRjYW5vbmljYWxVcmwpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGRvY3VtZW50LmhlYWQuaW5zZXJ0QWRqYWNlbnRIVE1MKCdiZWZvcmVlbmQnLCByZW5kZXJDYW5vbmljYWxMaW5rKHRoaXMuJGNhbm9uaWNhbFVybCkpOwogICAgfQogIH0sCiAgd2F0Y2g6IHsKICAgICRwYWdlOiBmdW5jdGlvbiAkcGFnZSgpIHsKICAgICAgdGhpcy51cGRhdGVNZXRhKCk7CiAgICAgIHRoaXMudXBkYXRlQ2Fub25pY2FsTGluaygpOwogICAgfQogIH0sCiAgYmVmb3JlRGVzdHJveTogZnVuY3Rpb24gYmVmb3JlRGVzdHJveSgpIHsKICAgIHVwZGF0ZU1ldGFUYWdzKG51bGwsIHRoaXMuY3VycmVudE1ldGFUYWdzKTsKICAgIHJlbW92ZUNhbm9uaWNhbExpbmsoKTsKICB9Cn07CgpmdW5jdGlvbiByZW1vdmVDYW5vbmljYWxMaW5rKCkgewogIHZhciBjYW5vbmljYWxFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoImxpbmtbcmVsPSdjYW5vbmljYWwnXSIpOwoKICBpZiAoY2Fub25pY2FsRWwpIHsKICAgIGNhbm9uaWNhbEVsLnJlbW92ZSgpOwogIH0KfQoKZnVuY3Rpb24gcmVuZGVyQ2Fub25pY2FsTGluaygpIHsKICB2YXIgbGluayA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogJyc7CgogIGlmICghbGluaykgewogICAgcmV0dXJuICcnOwogIH0KCiAgcmV0dXJuICI8bGluayBocmVmPVwiIi5jb25jYXQobGluaywgIlwiIHJlbD1cImNhbm9uaWNhbFwiIC8+Iik7Cn0KLyoqDQogKiBSZXBsYWNlIGN1cnJlbnRNZXRhVGFncyB3aXRoIG5ld01ldGFUYWdzDQogKiBAcGFyYW0ge0FycmF5PE9iamVjdD59IG5ld01ldGFUYWdzDQogKiBAcGFyYW0ge0FycmF5PEhUTUxFbGVtZW50Pn0gY3VycmVudE1ldGFUYWdzDQogKiBAcmV0dXJucyB7QXJyYXk8SFRNTEVsZW1lbnQ+fQ0KICovCgoKZnVuY3Rpb24gdXBkYXRlTWV0YVRhZ3MobmV3TWV0YVRhZ3MsIGN1cnJlbnRNZXRhVGFncykgewogIGlmIChjdXJyZW50TWV0YVRhZ3MpIHsKICAgIF90b0NvbnN1bWFibGVBcnJheShjdXJyZW50TWV0YVRhZ3MpLmZpbHRlcihmdW5jdGlvbiAoYykgewogICAgICByZXR1cm4gYy5wYXJlbnROb2RlID09PSBkb2N1bWVudC5oZWFkOwogICAgfSkuZm9yRWFjaChmdW5jdGlvbiAoYykgewogICAgICByZXR1cm4gZG9jdW1lbnQuaGVhZC5yZW1vdmVDaGlsZChjKTsKICAgIH0pOwogIH0KCiAgaWYgKG5ld01ldGFUYWdzKSB7CiAgICByZXR1cm4gbmV3TWV0YVRhZ3MubWFwKGZ1bmN0aW9uIChtKSB7CiAgICAgIHZhciB0YWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdtZXRhJyk7CiAgICAgIE9iamVjdC5rZXlzKG0pLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIHRhZy5zZXRBdHRyaWJ1dGUoa2V5LCBtW2tleV0pOwogICAgICB9KTsKICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZCh0YWcpOwogICAgICByZXR1cm4gdGFnOwogICAgfSk7CiAgfQp9Ci8qKg0KICogVHJ5IHRvIGlkZW50aWZ5IGEgbWV0YSB0YWcgYnkgbmFtZSwgcHJvcGVydHkgb3IgaXRlbXByb3ANCiAqDQogKiBSZXR1cm4gYSBjb21wbGV0ZSBzdHJpbmcgaWYgbm9uZSBwcm92aWRlZA0KICogQHBhcmFtIHtPYmplY3R9IHRhZyBmcm9tIGZyb250bWF0dGVyIG9yIHNpdGVNZXRhVGFncw0KICogQHJldHVybnMge1N0cmluZ30NCiAqLwoKCmZ1bmN0aW9uIG1ldGFJZGVudGlmaWVyKHRhZykgewogIGZvciAodmFyIF9pID0gMCwgX2FyciA9IFsnbmFtZScsICdwcm9wZXJ0eScsICdpdGVtcHJvcCddOyBfaSA8IF9hcnIubGVuZ3RoOyBfaSsrKSB7CiAgICB2YXIgaXRlbSA9IF9hcnJbX2ldOwogICAgaWYgKHRhZy5oYXNPd25Qcm9wZXJ0eShpdGVtKSkgcmV0dXJuIHRhZ1tpdGVtXSArIGl0ZW07CiAgfQoKICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodGFnKTsKfQovKioNCiAqIFJlbmRlciBtZXRhIHRhZ3MNCiAqDQogKiBAcGFyYW0ge0FycmF5fSBtZXRhDQogKiBAcmV0dXJucyB7U3RyaW5nfQ0KICovCgoKZnVuY3Rpb24gcmVuZGVyUGFnZU1ldGEobWV0YSkgewogIGlmICghbWV0YSkgcmV0dXJuICcnOwogIHJldHVybiBtZXRhLm1hcChmdW5jdGlvbiAobSkgewogICAgdmFyIHJlcyA9ICI8bWV0YSI7CiAgICBPYmplY3Qua2V5cyhtKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgcmVzICs9ICIgIi5jb25jYXQoa2V5LCAiPVwiIikuY29uY2F0KG1ba2V5XSwgIlwiIik7CiAgICB9KTsKICAgIHJldHVybiByZXMgKyAiPiI7CiAgfSkuam9pbignXG4gICAgJyk7Cn0="},{"version":3,"sources":["D:/xingkong/lzx-vuepress/node_modules/@vuepress/core/lib/client/root-mixins/updateMeta.js"],"names":["unionBy","created","siteMeta","$site","headTags","filter","headerType","map","_","headerValue","$ssrContext","mergedMetaItems","getMergedMetaTags","title","$title","lang","$lang","pageMeta","renderPageMeta","canonicalLink","renderCanonicalLink","$canonicalUrl","mounted","currentMetaTags","document","querySelectorAll","updateMeta","updateCanonicalLink","methods","documentElement","newMetaTags","updateMetaTags","$page","frontmatter","meta","name","content","$description","metaIdentifier","removeCanonicalLink","head","insertAdjacentHTML","watch","beforeDestroy","canonicalEl","querySelector","remove","link","c","parentNode","forEach","removeChild","m","tag","createElement","Object","keys","key","setAttribute","appendChild","item","hasOwnProperty","JSON","stringify","res","join"],"mappings":"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","sourcesContent":["import unionBy from 'lodash/unionBy'\r\n\r\nexport default {\r\n  // created will be called on both client and ssr\r\n  created () {\r\n    this.siteMeta = this.$site.headTags\r\n      .filter(([headerType]) => headerType === 'meta')\r\n      .map(([_, headerValue]) => headerValue)\r\n\r\n    if (this.$ssrContext) {\r\n      const mergedMetaItems = this.getMergedMetaTags()\r\n\r\n      this.$ssrContext.title = this.$title\r\n      this.$ssrContext.lang = this.$lang\r\n      this.$ssrContext.pageMeta = renderPageMeta(mergedMetaItems)\r\n      this.$ssrContext.canonicalLink = renderCanonicalLink(this.$canonicalUrl)\r\n    }\r\n  },\r\n  // Other life cycles will only be called at client\r\n  mounted () {\r\n    // init currentMetaTags from DOM\r\n    this.currentMetaTags = [...document.querySelectorAll('meta')]\r\n\r\n    // update title / meta tags\r\n    this.updateMeta()\r\n    this.updateCanonicalLink()\r\n  },\r\n\r\n  methods: {\r\n    updateMeta () {\r\n      document.title = this.$title\r\n      document.documentElement.lang = this.$lang\r\n\r\n      const newMetaTags = this.getMergedMetaTags()\r\n      this.currentMetaTags = updateMetaTags(newMetaTags, this.currentMetaTags)\r\n    },\r\n\r\n    getMergedMetaTags () {\r\n      const pageMeta = this.$page.frontmatter.meta || []\r\n      // pageMetaTags have higher priority than siteMetaTags\r\n      // description needs special attention as it has too many entries\r\n      return unionBy([{ name: 'description', content: this.$description }],\r\n        pageMeta, this.siteMeta, metaIdentifier)\r\n    },\r\n\r\n    updateCanonicalLink () {\r\n      removeCanonicalLink()\r\n\r\n      if (!this.$canonicalUrl) {\r\n        return\r\n      }\r\n\r\n      document.head.insertAdjacentHTML('beforeend', renderCanonicalLink(this.$canonicalUrl))\r\n    }\r\n  },\r\n\r\n  watch: {\r\n    $page () {\r\n      this.updateMeta()\r\n      this.updateCanonicalLink()\r\n    }\r\n  },\r\n\r\n  beforeDestroy () {\r\n    updateMetaTags(null, this.currentMetaTags)\r\n    removeCanonicalLink()\r\n  }\r\n}\r\n\r\nfunction removeCanonicalLink () {\r\n  const canonicalEl = document.querySelector(\"link[rel='canonical']\")\r\n\r\n  if (canonicalEl) {\r\n    canonicalEl.remove()\r\n  }\r\n}\r\n\r\nfunction renderCanonicalLink (link = '') {\r\n  if (!link) {\r\n    return ''\r\n  }\r\n  return `<link href=\"${link}\" rel=\"canonical\" />`\r\n}\r\n\r\n/**\r\n * Replace currentMetaTags with newMetaTags\r\n * @param {Array<Object>} newMetaTags\r\n * @param {Array<HTMLElement>} currentMetaTags\r\n * @returns {Array<HTMLElement>}\r\n */\r\nfunction updateMetaTags (newMetaTags, currentMetaTags) {\r\n  if (currentMetaTags) {\r\n    [...currentMetaTags]\r\n          .filter(c => c.parentNode === document.head)\r\n          .forEach(c => document.head.removeChild(c))\r\n  }\r\n  if (newMetaTags) {\r\n    return newMetaTags.map(m => {\r\n      const tag = document.createElement('meta')\r\n      Object.keys(m).forEach(key => {\r\n        tag.setAttribute(key, m[key])\r\n      })\r\n      document.head.appendChild(tag)\r\n      return tag\r\n    })\r\n  }\r\n}\r\n\r\n/**\r\n * Try to identify a meta tag by name, property or itemprop\r\n *\r\n * Return a complete string if none provided\r\n * @param {Object} tag from frontmatter or siteMetaTags\r\n * @returns {String}\r\n */\r\nfunction metaIdentifier (tag) {\r\n  for (const item of ['name', 'property', 'itemprop']) {\r\n    if (tag.hasOwnProperty(item)) return tag[item] + item\r\n  }\r\n  return JSON.stringify(tag)\r\n}\r\n\r\n/**\r\n * Render meta tags\r\n *\r\n * @param {Array} meta\r\n * @returns {String}\r\n */\r\n\r\nfunction renderPageMeta (meta) {\r\n  if (!meta) return ''\r\n  return meta.map(m => {\r\n    let res = `<meta`\r\n    Object.keys(m).forEach(key => {\r\n      res += ` ${key}=\"${m[key]}\"`\r\n    })\r\n    return res + `>`\r\n  }).join('\\n    ')\r\n}\r\n"]}]}